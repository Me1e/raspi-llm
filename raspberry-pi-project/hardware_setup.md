# Raspberry Pi AI 음성 어시스턴트 하드웨어 설정

이 문서는 AI 음성 어시스턴트 프로젝트를 위해 라즈베리파이4에 연결되는 하드웨어 부품 및 연결 방법을 상세히 설명합니다.

## 1. 필요 부품 목록 (BOM)

- 라즈베리파이 4 모델 B (Raspberry Pi 4 Model B)
- 브레드보드 (Breadboard, 중간 크기 이상)
- 점퍼 와이어 (Jumper Wires, Male-to-Male, Male-to-Female)
- LEDs:
  - 초록색 LED (Green LED) 1개
  - 노란색 LED (Yellow LED) 1개
  - 빨간색 LED (Red LED) 1개
  - 흰색 LED (White LED) 1개
- 저항 (Resistors):
  - 220Ω 또는 330Ω 저항 4개 (각 LED용)
- 서보 모터 (Servo Motor):
  - SG90 마이크로 서보 1개 (또는 유사 5V 서보)
- 초음파 센서 (Ultrasonic Sensor):
  - HC-SR04 1개
- OLED 디스플레이 (OLED Display):
  - SSD1306 I2C OLED 디스플레이 (128x64) 1개
- USB 마이크 (웹 클라이언트 PC에서 사용)
- 스피커 (웹 클라이언트 PC 또는 라즈베리파이에 연결된 스피커)

## 2. 라즈베리파이 4 GPIO 핀 배치 참조

라즈베리파이 GPIO 핀 배치를 참조하는 것이 매우 중요합니다. `main.py` 코드에서는 **BCM 넘버링**을 사용하여 GPIO 핀을 지정할 것입니다.

유용한 참조 사이트: [https://pinout.xyz/](https://pinout.xyz/)

주요 사용 핀:

- **5V 전원**: 물리적 핀 2, 4
- **3.3V 전원**: 물리적 핀 1, 17
- **GND (그라운드)**: 물리적 핀 6, 9, 14, 20, 25, 30, 34, 39
- **I2C 통신용**: (OLED 디스플레이용)
  - GPIO2 (SDA): 물리적 핀 3
  - GPIO3 (SCL): 물리적 핀 5
- **일반 GPIO 핀들**: (LED, 서보 모터, 초음파 센서용) - 특정 BCM 번호 핀들을 선택합니다.

## 3. 부품별 연결 지침

**일반 주의사항:**

- 배선 변경 전에는 항상 라즈베리파이의 전원을 차단하십시오.
- 전원을 켜기 전에 모든 연결을 다시 한번 확인하십시오.
- LED에는 과전류 방지 및 손상 방지를 위해 저항 연결이 필수입니다.

### 3.1 LED (초록, 노랑, 빨강, 흰색)

- **목적**: AI의 시각적 피드백 제공.
- **부품**: LED 4개, 220Ω (또는 330Ω) 저항 4개.
- **연결 방법**:

  - 각 LED는 긴 다리(애노드, +)와 짧은 다리(캐소드, -)가 있습니다.
  - 각 LED의 **애노드(+)**를 저항의 한쪽 끝에 연결합니다.
  - 저항의 다른 쪽 끝을 라즈베리파이의 선택된 GPIO 핀에 연결합니다.
  - 각 LED의 **캐소드(-)**를 라즈베리파이의 GND 핀에 연결합니다.

- **제안된 GPIO 핀 (BCM 넘버링, `main.py`에서 변경 가능):**

  - **초록색 LED**: 저항 -> GPIO 17 (물리적 핀 11)
  - **노란색 LED**: 저항 -> GPIO 27 (물리적 핀 13)
  - **빨간색 LED**: 저항 -> GPIO 22 (물리적 핀 15)
  - **흰색 LED**: 저항 -> GPIO 10 (물리적 핀 19) (예시, 사용 가능한 다른 핀으로 변경 가능)
  - **모든 LED 캐소드 (-)**: -> GND (예: 물리적 핀 6 또는 다른 GND 핀)

  **연결도 예시 (LED 1개 기준):**

  ```
  라즈베리파이                      브레드보드
  ----------------                   ------------------------------------
  GPIO X (예: 17) ------> [저항] ------> LED 애노드 (+)
  GND               ------> LED 캐소드 (-)
  ```

### 3.2 서보 모터 (SG90)

- **목적**: AI 명령에 따른 물리적 움직임 구현.
- **부품**: SG90 서보 모터 1개.
- **연결 방법**: SG90은 일반적으로 3개의 선을 가집니다:

  - **빨간색 선**: 전원 (라즈베리파이 5V에 연결)
  - **갈색 (또는 검은색) 선**: 그라운드 (라즈베리파이 GND에 연결)
  - **주황색 (또는 노란색) 선**: 신호/PWM (라즈베리파이의 PWM 가능 GPIO 핀에 연결)

- **제안된 GPIO 핀 (BCM 넘버링, `main.py`에서 변경 가능):**

  - **서보 신호선**: GPIO 18 (물리적 핀 12) - 하드웨어 PWM 지원 핀.
  - **서보 전원 (빨간색)**: -> 5V (물리적 핀 2 또는 4)
  - **서보 그라운드 (갈색/검은색)**: -> GND (물리적 핀 6 또는 다른 GND 핀)

  **주의**: 서보 모터를 라즈베리파이의 5V 핀에서 직접 구동할 경우, 서보가 과도한 전류를 소비하면 불안정해질 수 있습니다. 여러 개 또는 큰 서보를 사용할 경우 외부 전원 공급 장치가 권장됩니다. SG90 1개의 간단한 움직임에는 일반적으로 괜찮습니다.

### 3.3 초음파 센서 (HC-SR04)

- **목적**: 장애물까지의 거리 측정.
- **부품**: HC-SR04 센서 1개.
- **연결 방법**: HC-SR04는 일반적으로 4개의 핀을 가집니다:

  - **VCC**: 전원 (라즈베리파이 5V에 연결)
  - **Trig (트리거)**: 파이로부터의 입력 신호 (GPIO 핀에 연결)
  - **Echo (에코)**: 파이로의 출력 신호 (GPIO 핀에 연결). **전압 분배기 필요** (Echo는 5V 신호를 보내지만, 파이 GPIO는 3.3V 허용).
  - **GND**: 그라운드 (라즈베리파이 GND에 연결)

- **Echo 핀을 위한 전압 분배기**:

  - 저항 2개 사용 (예: R1 = 1kΩ, R2 = 2kΩ 또는 유사 비율로 약 3.3V 제공). 흔히 사용되는 330Ω과 470Ω 조합을 사용합니다.
    `Echo 핀 (센서) --- 330Ω 저항 --- GPIO 핀 (파이) --- 470Ω 저항 --- GND (파이)`
  - Echo 입력용 GPIO 핀은 두 저항 사이에 연결됩니다.

- **제안된 GPIO 핀 (BCM 넘버링, `main.py`에서 변경 가능):**
  - **Trig 핀**: GPIO 23 (물리적 핀 16)
  - **Echo 핀 (전압 분배기 통해)**: GPIO 24 (물리적 핀 18)
  - **센서 VCC**: -> 5V (물리적 핀 2 또는 4)
  - **센서 GND**: -> GND (물리적 핀 6 또는 다른 GND 핀)

### 3.4 OLED 디스플레이 (SSD1306 I2C)

- **목적**: AI의 텍스트 피드백 표시.
- **부품**: SSD1306 I2C OLED 디스플레이 1개.
- **연결 방법**: I2C OLED는 일반적으로 4개의 핀을 가집니다:

  - **VCC**: 전원 (라즈베리파이 3.3V에 연결 - OLED 모듈의 전압 요구사항 확인, 일부는 5V 허용하나 3.3V가 I2C 라인에 더 안전)
  - **GND**: 그라운드 (라즈베리파이 GND에 연결)
  - **SCL (Serial Clock)**: 라즈베리파이의 SCL 핀 (GPIO3)에 연결
  - **SDA (Serial Data)**: 라즈베리파이의 SDA 핀 (GPIO2)에 연결

- **I2C 핀 (라즈베리파이에서 고정):**

  - **SDA**: GPIO 2 (물리적 핀 3)
  - **SCL**: GPIO 3 (물리적 핀 5)
  - **OLED VCC**: -> 3.3V (물리적 핀 1 또는 17)
  - **OLED GND**: -> GND (물리적 핀 9 또는 다른 GND 핀)

  **참고**: SSD1306의 I2C 주소는 보통 `0x3C` 또는 `0x3D`입니다. 참조 코드에서는 `0x3C`를 사용합니다. 디스플레이가 작동하지 않으면 이 주소를 확인/변경해야 할 수 있습니다. 참조 코드의 `oled_reset` 핀 (board.D4 / BCM 4)은 일부 모듈에는 선택 사항입니다. 모듈에 RESET 핀이 없거나 필요하지 않다면 생략하거나 3.3V에 연결할 수 있습니다. 여기서는 사용 가능한 경우 해당 리셋 핀을 연결하는 것으로 가정합니다.

  - **OLED Reset (선택 사항, 모듈에 있고 BCM 4 / GPIO4 사용 시)**: -> GPIO 4 (물리적 핀 7)

## 4. 전체 연결 요약 (GPIO BCM 번호 기준)

- **초록색 LED**: GPIO 17 (저항 통해)
- **노란색 LED**: GPIO 27 (저항 통해)
- **빨간색 LED**: GPIO 22 (저항 통해)
- **흰색 LED**: GPIO 10 (저항 통해)
- **서보 모터 신호선**: GPIO 18
- **초음파 센서 Trig**: GPIO 23
- **초음파 센서 Echo**: GPIO 24 (전압 분배기 통해: Echo_Sensor -- 330R -- GPIO24 -- 470R -- GND)
- **OLED SDA**: GPIO 2
- **OLED SCL**: GPIO 3
- **OLED Reset (선택 사항)**: GPIO 4

- **전원 연결**:
  - 서보 모터 VCC: 5V
  - 초음파 센서 VCC: 5V
  - OLED VCC: 3.3V
- **그라운드 연결**: 모든 부품의 GND 핀을 라즈베리파이의 공통 GND에 연결합니다.

## 5. 소프트웨어 라이브러리 및 설정 (`main.py`를 위한 요약)

- **RPi.GPIO**: LED, 서보 모터(PWM 부분), 초음파 센서(Trig) 제어.
- **adafruit_circuitpython_ssd1306** 및 **Pillow**: OLED 디스플레이 제어.
  - 가상 환경 내에 설치: `pip install adafruit-circuitpython-ssd1306 Pillow board busio digitalio`
  - `board`, `busio`, `digitalio`는 Adafruit 라이브러리가 내부적으로 또는 시스템 레벨에서 필요로 할 수 있습니다. (`--system-site-packages`로 가상환경 생성 시 시스템 것을 사용 가능)
- 라즈베리파이에서 I2C 활성화 확인 (`sudo raspi-config`).

## 6. 중요 주의사항

- **정전기**: 부품, 특히 라즈베리파이를 다룰 때 주의하십시오.
- **정확한 극성**: LED가 올바른 극성(애노드/캐소드)으로 연결되었는지 확인하십시오.
- **전압 레벨**:
  - 라즈베리파이 GPIO는 3.3V입니다. 5V 신호를 레벨 시프터나 전압 분배기 없이 GPIO 입력 핀에 직접 연결하지 마십시오 (HC-SR04 Echo 핀의 경우처럼).
  - 5V가 필요한 부품(서보, HC-SR04 VCC)에는 5V를 공급하십시오.
  - 3.3V가 필요한 부품(일반적으로 OLED VCC, 모듈 확인)에는 3.3V를 공급하십시오.
- **전류 소모**: 파이의 5V 및 3.3V 핀에서 소모되는 총 전류에 유의하십시오. 전력 소모가 많은 부품을 여러 개 사용하는 경우, 해당 부품을 위한 외부 전원 공급 장치가 필요할 수 있습니다. 현재 구성된 부품들의 경우, 서보 모터의 움직임이 너무 공격적이거나 지속적이지 않다면 파이가 일반적으로 감당할 수 있습니다.
- **배선 확인**: 라즈베리파이에 전원을 공급하기 전에 모든 배선을 다시 한번 확인하십시오. 잘못된 배선은 파이나 부품을 손상시킬 수 있습니다.
- **GPIO 정리**: Python 스크립트 종료 시 `GPIO.cleanup()`이 호출되어 GPIO 리소스를 해제하도록 하십시오.

이 문서는 텍스트 기반 안내입니다. 시각적 표현을 위해서는 Fritzing과 같은 도구를 사용하거나 회로도를 그릴 수 있지만, 위 텍스트 설명으로도 브레드보드 배선에 충분히 명확할 것입니다.
